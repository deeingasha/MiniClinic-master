import{a as Y,r as f,j as e,B as k,a0 as y,a1 as Z,L as _}from"./index-BRWRaBLH.js";import{D as E}from"./data-table-BOSARfye.js";import{B as Q}from"./badge-CKfgLMBR.js";import{S as I,a as V,b as P,c as M,d as n}from"./select-CFofVa8Z.js";import{I as g}from"./input-9ilivggF.js";import{u as ee,s as se,F as ae,a as h,b as u,c as x,d as j,e as p,z as d}from"./form-DQjq2XJ8.js";import{D as O,a as z,b as $,c as H}from"./dialog-CtbNDcPh.js";import{S as le,A as re,a as te}from"./Snackbar-NOJSlihj.js";import{A as ne}from"./Alert-DQkTtXKW.js";import{F as ce}from"./funnel-6-Pxvc-2.js";import{E as oe}from"./eye-D2j_VXOL.js";import"./table-DGHHzcga.js";import"./label-tdp-vDk0.js";import"./index-C544f_aa.js";import"./x-DmMHP_ZF.js";const ie=[{value:"patient",label:"Patient"},{value:"nurse",label:"Nurse"},{value:"admin",label:"Admin"},{value:"finance",label:"Finance"},{value:"pharmacist",label:"Pharmacist"},{value:"doctor",label:"Doctor"},{value:"receptionist",label:"Receptionist"},{value:"pathologist",label:"Pathologist"}],de=d.object({entityType:d.enum(["nurse","receptionist","patient","admin","finance","pathologist","pharmacist"]),firstName:d.string().min(1,"First name is required"),middleName:d.string().optional(),lastName:d.string().min(1,"Last name is required"),phone:d.string().min(1,"Phone number is required"),sex:d.enum(["male","female"]),idType:d.enum(["passport","national id"]),idNumber:d.string().min(1,"ID number is required"),passportNumber:d.string().optional(),dob:d.date(),address:d.string().optional(),maritalStatus:d.enum(["single","married","divorced","widowed"]),email:d.string().email().optional()});function G({open:L,onClose:v,onEntityCreated:F,existingEntity:a,isEditing:w=!1}){const q=Y(),[D,o]=f.useState(!1),[R,B]=f.useState(""),K={entityType:(a==null?void 0:a.role)||"patient",firstName:(a==null?void 0:a.firstName)||"",middleName:"",lastName:(a==null?void 0:a.lastName)||"",phone:(a==null?void 0:a.phone)||"",sex:"male",idType:"national id",idNumber:"",passportNumber:"",dob:new Date,address:"",maritalStatus:"single",email:(a==null?void 0:a.email)||""},r=ee({resolver:se(de),defaultValues:K}),A=()=>{o(!1)},b=s=>{let m;if(w&&a)m=a.id;else{let S=1;if(y.length>0){const C=y[y.length-1];if(C&&C.id){const U=C.id.match(/(\w+)-(\d+)/);U&&U[2]&&(S=parseInt(U[1])+1)}}m=`PAT-${S.toString().padStart(3,"0")}`}const T={id:m,firstName:s.firstName,lastName:s.lastName,phone:s.phone,email:s.email||"",role:s.entityType,password:a==null?void 0:a.password,department:a==null?void 0:a.department,shift:a==null?void 0:a.shift,username:(a==null?void 0:a.username)||""};if(w){const S=y.findIndex(C=>C.id===m);S!==-1&&(y[S]=T)}else y.push(T);B(w?"Entity updated successfully!":"Entity created successfully!"),o(!0),r.reset(),F&&F(T),setTimeout(()=>{v==null||v(),s.entityType==="patient"&&!w&&q(`/healthcare/registration/${T.id}`)},1500)};return e.jsxs(e.Fragment,{children:[e.jsx(O,{open:L,onOpenChange:s=>!s&&(v==null?void 0:v()),children:e.jsxs(z,{className:"min-w-4xl w-full",children:[e.jsx($,{children:e.jsx(H,{className:"text-lg font-medium",children:w?"Edit Entity":"Add New Entity"})}),e.jsx("div",{className:"p-3 pt-2",children:e.jsx(ae,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(b),className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(h,{control:r.control,name:"entityType",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Entity Type"}),e.jsxs(I,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(j,{children:e.jsx(V,{className:"w-full",children:e.jsx(P,{placeholder:"Select entity type"})})}),e.jsx(M,{children:ie.map(m=>e.jsx(n,{value:m.value,children:m.label},m.value))})]}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"firstName",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"First Name"}),e.jsx(j,{children:e.jsx(g,{placeholder:"First name",...s})}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"middleName",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Middle Name"}),e.jsx(j,{children:e.jsx(g,{placeholder:"Middle name",...s})}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"lastName",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Last Name"}),e.jsx(j,{children:e.jsx(g,{placeholder:"Last name",...s})}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"phone",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Phone"}),e.jsx(j,{children:e.jsx(g,{placeholder:"Phone number",...s})}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"email",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Email"}),e.jsx(j,{children:e.jsx(g,{placeholder:"Email address",type:"email",...s})}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"dob",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Date of Birth"}),e.jsx(j,{children:e.jsx(g,{type:"date",...s,value:s.value?new Date(s.value).toISOString().split("T")[0]:"",onChange:m=>s.onChange(m.target.valueAsDate)})}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"sex",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Sex"}),e.jsxs(I,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(j,{children:e.jsx(V,{className:"w-full",children:e.jsx(P,{placeholder:"Select sex"})})}),e.jsxs(M,{children:[e.jsx(n,{value:"male",children:"Male"}),e.jsx(n,{value:"female",children:"Female"})]})]}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"idType",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"ID Type"}),e.jsxs(I,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(j,{children:e.jsx(V,{className:"w-full",children:e.jsx(P,{placeholder:"Select ID type"})})}),e.jsxs(M,{children:[e.jsx(n,{value:"passport",children:"Passport"}),e.jsx(n,{value:"national id",children:"National ID"})]})]}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"idNumber",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"ID Number"}),e.jsx(j,{children:e.jsx(g,{placeholder:"ID number",...s})}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"maritalStatus",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Marital Status"}),e.jsxs(I,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(j,{children:e.jsx(V,{className:"w-full",children:e.jsx(P,{placeholder:"Select marital status"})})}),e.jsxs(M,{children:[e.jsx(n,{value:"single",children:"Single"}),e.jsx(n,{value:"married",children:"Married"}),e.jsx(n,{value:"divorced",children:"Divorced"}),e.jsx(n,{value:"widowed",children:"Widowed"})]})]}),e.jsx(p,{className:"text-xs"})]})}),e.jsx(h,{control:r.control,name:"address",render:({field:s})=>e.jsxs(u,{children:[e.jsx(x,{children:"Address"}),e.jsx(j,{children:e.jsx(g,{placeholder:"Address",...s})}),e.jsx(p,{className:"text-xs"})]})})]}),e.jsxs("div",{className:"flex items-end justify-end gap-2 mt-4",children:[e.jsx(k,{variant:"outline",type:"button",onClick:v,children:"Cancel"}),e.jsx(k,{type:"submit",children:"Create Entity"})]})]})})})]})}),e.jsx(le,{open:D,autoHideDuration:6e3,onClose:A,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsxs(ne,{onClose:A,severity:"success",sx:{width:"100%"},children:[e.jsx(re,{children:"Success"}),R]})})]})}function Le(){const[L]=f.useState(y),[v,F]=f.useState(y),[a,w]=f.useState(!1),[q,D]=f.useState(!1),[o,R]=f.useState(null),[B,K]=f.useState(!1),[r,A]=f.useState(""),[b,s]=f.useState("");f.useEffect(()=>{let t=[...L];if(r&&(t=t.filter(i=>i.role.toLowerCase()===r.toLowerCase())),b){const i=b.toLowerCase();t=t.filter(l=>l.firstName.toLowerCase().includes(i)||l.lastName.toLowerCase().includes(i)||l.email.toLowerCase().includes(i)||l.id.toLowerCase().includes(i)||l.phone.toLowerCase().includes(i))}F(t)},[r,b,L]);const m=t=>{R(t),D(!0)},T=t=>{R(t),K(!0)},S=t=>{switch(t){case"doctor":return"bg-blue-100 text-blue-800";case"nurse":return"bg-green-100 text-green-800";case"receptionist":return"bg-purple-100 text-purple-800";case"patient":return"bg-amber-100 text-amber-800";case"admin":return"bg-red-100 text-red-800";case"finance":return"bg-emerald-100 text-emerald-800";case"pathologist":return"bg-indigo-100 text-indigo-800";case"pharmacist":return"bg-teal-100 text-teal-800";default:return"bg-gray-100 text-gray-800"}},C=t=>{let l=L.map(c=>c.id===t.id?t:c);if(r&&(l=l.filter(c=>c.role.toLowerCase()===r.toLowerCase())),b){const c=b.toLowerCase();l=l.filter(N=>N.firstName.toLowerCase().includes(c)||N.lastName.toLowerCase().includes(c)||N.email.toLowerCase().includes(c)||N.id.toLowerCase().includes(c)||N.phone.toLowerCase().includes(c))}F(l),D(!1)},U=()=>{w(!0)},W=()=>{w(!1)},J=t=>{let l=[...L,t];if(r&&(l=l.filter(c=>c.role.toLowerCase()===r.toLowerCase())),b){const c=b.toLowerCase();l=l.filter(N=>N.firstName.toLowerCase().includes(c)||N.lastName.toLowerCase().includes(c)||N.email.toLowerCase().includes(c)||N.id.toLowerCase().includes(c)||N.phone.toLowerCase().includes(c))}F(l)},X=[{accessorKey:"id",header:"ID"},{accessorKey:"firstName",header:"First Name"},{accessorKey:"lastName",header:"Last Name"},{accessorKey:"email",header:"Email"},{accessorKey:"phone",header:"Phone"},{accessorKey:"role",header:"Entity Type",cell:({row:t})=>{const i=t.getValue("role");let l;switch(i){case"doctor":l="bg-blue-100 text-blue-800";break;case"nurse":l="bg-green-100 text-green-800";break;case"receptionist":l="bg-purple-100 text-purple-800";break;case"patient":l="bg-amber-100 text-amber-800";break;case"admin":l="bg-red-100 text-red-800";break;case"finance":l="bg-emerald-100 text-emerald-800";break;case"pathologist":l="bg-indigo-100 text-indigo-800";break;case"pharmacist":l="bg-teal-100 text-teal-800";break;default:l="bg-gray-100 text-gray-800"}return e.jsx(Q,{variant:"outline",className:l,children:i})}},{id:"actions",header:"Actions",cell:({row:t})=>{const i=t.original;return e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>T(i),className:"h-8 w-8 p-0 text-blue-600 border-blue-600",children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"View"})]}),e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>m(i),className:"h-8 w-8 p-0 text-gray-600 border-gray-600",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]})]})}}];return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"mb-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Entity Registration"}),e.jsx("p",{className:"text-gray-500",children:"Manage users, patients, doctors and other entities"})]}),e.jsxs(k,{onClick:U,className:"gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Add New Entity"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-1 flex items-center justify-between",children:e.jsx("h3",{className:"text-lg font-medium",children:"Filters"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-end",children:[e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx(g,{placeholder:"Search by name, email, phone or ID...",value:b,onChange:t=>s(t.target.value),className:"pl-9 w-full"})]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entity Type"}),e.jsxs(I,{value:r,onValueChange:A,children:[e.jsx(V,{className:"w-full",children:e.jsx(P,{placeholder:"All Entity Types"})}),e.jsxs(M,{children:[e.jsx(n,{value:"patient",children:"Patient"}),e.jsx(n,{value:"doctor",children:"Doctor"}),e.jsx(n,{value:"nurse",children:"Nurse"}),e.jsx(n,{value:"receptionist",children:"Receptionist"}),e.jsx(n,{value:"admin",children:"Admin"}),e.jsx(n,{value:"finance",children:"Finance"}),e.jsx(n,{value:"pathologist",children:"Pathologist"}),e.jsx(n,{value:"pharmacist",children:"Pharmacist"})]})]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs(I,{value:r,onValueChange:A,children:[e.jsx(V,{className:"w-full",children:e.jsx(P,{placeholder:"Status"})}),e.jsxs(M,{children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"active",children:"Active"}),e.jsx(n,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx("div",{className:"md:col-span-2 flex justify-end",children:e.jsx(k,{variant:"outline",onClick:()=>{A(""),s("")},className:"h-10 w-full",children:"Reset"})})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:e.jsx(E,{columns:X,data:v,showGlobalFilter:!1})}),e.jsx(G,{open:a,onClose:W,onEntityCreated:J}),o&&e.jsx(O,{open:q,onOpenChange:D,children:e.jsxs(z,{className:"min-w-4xl w-full",children:[e.jsx($,{children:e.jsx(H,{className:"text-lg font-medium",children:"Edit Entity"})}),e.jsx(G,{open:q,onClose:()=>D(!1),onEntityCreated:C,existingEntity:o,isEditing:!0})]})}),o&&e.jsx(O,{open:B,onOpenChange:K,children:e.jsxs(z,{className:"min-w-4xl w-full",children:[e.jsx($,{children:e.jsx(H,{className:"text-lg font-medium",children:o.role==="patient"?"Patient Details":"Entity Details"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"ID"}),e.jsx("p",{className:"font-medium",children:o.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Name"}),e.jsxs("p",{className:"font-medium",children:[o.firstName," ",o.lastName]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium",children:o.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),e.jsx("p",{className:"font-medium",children:o.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Entity Type"}),e.jsx(Q,{variant:"outline",className:S(o.role),children:o.role})]})]}),o.role==="patient"&&e.jsx("div",{className:"mt-4",children:e.jsx(_,{to:`/healthcare/entity-registration/${o.id}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"View Full Patient Details"})})]})]})})]})}export{Le as default};
